{% extends "base_admin.html" %}

{% block title %}Gateways - WHAGO Admin{% endblock %}
{% block page_title %}Configura√ß√£o de Pagamentos{% endblock %}
{% block data_page %}admin-gateways{% endblock %}

{% block content %}
<div class="admin-card" style="margin-bottom: 1.5rem;">
    <div style="background: #fff3cd; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid #ffc107;">
        <strong>‚ö†Ô∏è Aten√ß√£o:</strong> Estas configura√ß√µes controlam os m√©todos de pagamento do sistema. 
        Altere apenas se souber o que est√° fazendo!
    </div>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h3 style="margin: 0;">Gateways de Pagamento</h3>
        <button class="btn btn-primary" onclick="loadGateways()">
            <i class="fas fa-sync"></i> Atualizar
        </button>
    </div>

    <div id="gatewaysContainer">
        <div class="loading">
            <i class="fas fa-spinner fa-spin"></i> Carregando...
        </div>
    </div>
</div>

<!-- Modal de Edi√ß√£o de Gateway -->
<div id="editGatewayModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h3 class="modal-title">Configurar Gateway</h3>
            <button class="modal-close" onclick="closeEditGatewayModal()">&times;</button>
        </div>
        <form id="editGatewayForm">
            <input type="hidden" id="editGatewayId">
            
            <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                <h4 style="margin: 0 0 0.5rem 0;" id="gatewayTitle"></h4>
                <p style="margin: 0; color: #1565c0;" id="gatewayDescription"></p>
            </div>

            <div class="form-group">
                <label class="form-label">
                    <input type="checkbox" id="editGatewayEnabled"> Gateway Habilitado
                </label>
                <small style="color: #718096;">Se desabilitado, os clientes n√£o poder√£o usar este m√©todo de pagamento</small>
            </div>

            <div class="form-group">
                <label class="form-label">Modo de Opera√ß√£o *</label>
                <select id="editGatewayMode" class="form-control">
                    <option value="false">üß™ Sandbox (Teste) - N√£o cobra valores reais</option>
                    <option value="true">üí∞ Produ√ß√£o - Cobra valores reais</option>
                </select>
            </div>

            <hr style="margin: 2rem 0;">

            <!-- Sandbox Credentials -->
            <div style="background: #fff8dc; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                <h4 style="margin: 0 0 1rem 0;">üß™ Credenciais Sandbox (Teste)</h4>
                
                <div class="form-group">
                    <label class="form-label">Access Token / API Key</label>
                    <input type="text" id="sandboxAccessToken" class="form-control" placeholder="TEST-...">
                </div>

                <div class="form-group">
                    <label class="form-label">Public Key</label>
                    <input type="text" id="sandboxPublicKey" class="form-control" placeholder="TEST-...">
                </div>

                <div class="form-group">
                    <label class="form-label">Webhook Secret</label>
                    <input type="text" id="sandboxWebhookSecret" class="form-control">
                </div>
            </div>

            <!-- Production Credentials -->
            <div style="background: #ffe0e0; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                <h4 style="margin: 0 0 1rem 0;">üí∞ Credenciais Produ√ß√£o (Real)</h4>
                
                <div class="form-group">
                    <label class="form-label">Access Token / API Key</label>
                    <input type="text" id="productionAccessToken" class="form-control" placeholder="APP-...">
                </div>

                <div class="form-group">
                    <label class="form-label">Public Key</label>
                    <input type="text" id="productionPublicKey" class="form-control" placeholder="APP-...">
                </div>

                <div class="form-group">
                    <label class="form-label">Webhook Secret</label>
                    <input type="text" id="productionWebhookSecret" class="form-control">
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeEditGatewayModal()">Cancelar</button>
                <button type="submit" class="btn btn-success">üíæ Salvar Configura√ß√£o</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    if (typeof loadGateways === 'function') {
        loadGateways();
    }
});
</script>
{% endblock %}

